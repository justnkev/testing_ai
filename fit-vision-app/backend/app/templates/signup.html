{% extends 'base.html' %}
{% block content %}
<div class="auth-card">
  <h1>Create your account</h1>
  <p style="text-align:center; color:var(--color-muted); margin-bottom:1.6rem;">Join FitVision to unlock a calm, data-informed coaching experience.</p>
  <form method="post">
    <div>
      <label for="name">Full name</label>
      <input id="name" name="name" type="text" required>
    </div>
    <div>
      <label for="email">Email</label>
      <input id="email" name="email" type="email" required>
    </div>
    <div>
      <label for="password">Password</label>
      <input id="password" name="password" type="password" minlength="6" required>
    </div>
    <div>
      <label for="confirm-password">Confirm password</label>
      <input id="confirm-password" name="confirm_password" type="password" minlength="6" required>
      <p id="password-error" style="display:none; margin:0.3rem 0 0; color: var(--color-accent); font-size:0.9rem;"></p>
    </div>
    <button class="fv-button fv-button--primary" type="submit">Sign up</button>
  </form>
  <p style="text-align:center; color:var(--color-muted); margin-top:1.6rem;">Already have an account? <a href="{{ url_for('main.login') }}">Log in</a>.</p>
</div>
<script>
  const signupForm = document.querySelector('.auth-card form');
  const passwordInput = document.getElementById('password');
  const confirmPasswordInput = document.getElementById('confirm-password');
  const passwordError = document.getElementById('password-error');

  const passwordsMatch = () => {
    const match = passwordInput.value === confirmPasswordInput.value;
    passwordError.textContent = match ? '' : 'Passwords do not match.';
    passwordError.style.display = match ? 'none' : 'block';
    return match;
  };

  confirmPasswordInput.addEventListener('blur', passwordsMatch);
  passwordInput.addEventListener('blur', passwordsMatch);

  signupForm.addEventListener('submit', (event) => {
    if (!passwordsMatch()) {
      event.preventDefault();
      confirmPasswordInput.focus();
    }
  });
</script>
{% endblock %}
